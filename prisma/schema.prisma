generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  super_user
  user
}

model User {
  id            String        @id @default(cuid())
  email         String        @unique
  firstname     String        @db.VarChar(20)
  password      String?
  lastname      String?       @db.VarChar(20)
  fullname      String?       @db.VarChar(40)
  provider      String?
  role          Role          @default(user)
  created_at    DateTime      @default(now())
  updated_at    DateTime      @updatedAt
  order_details OrderDetail[]
}

enum Provider {
  xl
  axis
  telkomsel
  byu
  smartfren
  indosat
  three
}

model Item {
  id            String        @id @default(cuid())
  title         String        @db.VarChar(50)
  price         Int
  stock         Int
  provider      Provider
  created_at    DateTime      @default(now())
  updated_at    DateTime      @updatedAt
  order_details OrderDetail[]
}

enum Status {
  pending
  paid
  expired
  failed
  cancelled
}

model OrderDetail {
  id             String   @id @default(cuid())
  transaction_id String   @unique
  amount         Int
  status         Status
  qris_url       String
  qris_string    String
  expires_at     String
  paid_at        String?
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
  user_id        String
  user           User     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  item_id        String
  item           Item     @relation(fields: [item_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
}
